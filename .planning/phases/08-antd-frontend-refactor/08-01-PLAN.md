---
phase: 08-antd-frontend-refactor
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/src/main.tsx
  - frontend/src/components/Toast/ToastProvider.tsx
  - frontend/src/hooks/useAntdApp.ts
autonomous: true

must_haves:
  truths:
    - "Ant Design components render with default theme"
    - "message.success() shows toast notifications"
    - "App builds without errors"
  artifacts:
    - path: "frontend/package.json"
      provides: "antd and @ant-design/icons dependencies"
      contains: "antd"
    - path: "frontend/src/main.tsx"
      provides: "ConfigProvider and App wrapper"
      contains: "ConfigProvider"
    - path: "frontend/src/hooks/useAntdApp.ts"
      provides: "Hook for message/modal/notification API"
      exports: ["useAntdApp"]
  key_links:
    - from: "frontend/src/main.tsx"
      to: "antd App component"
      via: "ConfigProvider > App wrapper"
      pattern: "<ConfigProvider>.*<App>"
---

<objective>
Install Ant Design and configure the application root with ConfigProvider and App wrapper to enable the message API and theming throughout the application.

Purpose: Ant Design's message, notification, and Modal.confirm APIs require context from the App component. This foundational setup enables all subsequent component migrations to use these APIs.

Output: Working antd installation with message API accessible via custom hook.
</objective>

<execution_context>
@C:\Users\abelb\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\abelb\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-antd-frontend-refactor/08-RESEARCH.md
@frontend/package.json
@frontend/src/main.tsx
@frontend/src/components/Toast/ToastProvider.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Ant Design packages and remove deprecated dependencies</name>
  <files>frontend/package.json</files>
  <action>
Run npm commands to install antd v6 and @ant-design/icons v6, then uninstall packages that will be replaced:

```bash
cd frontend
npm install antd@^6 @ant-design/icons@^6
npm uninstall react-dropzone @tanstack/react-table sonner
```

After running, verify package.json shows:
- antd: ^6.x.x
- @ant-design/icons: ^6.x.x
- react-dropzone: removed
- @tanstack/react-table: removed
- sonner: removed

Note: Removing these packages will cause TypeScript errors in components that use them. This is expected - subsequent plans will fix these imports.
  </action>
  <verify>npm ls antd @ant-design/icons shows both packages installed at v6.x</verify>
  <done>antd and @ant-design/icons v6 installed; react-dropzone, @tanstack/react-table, and sonner removed from dependencies</done>
</task>

<task type="auto">
  <name>Task 2: Create useAntdApp hook and wrap application root</name>
  <files>
    frontend/src/hooks/useAntdApp.ts
    frontend/src/main.tsx
  </files>
  <action>
1. Create `frontend/src/hooks/useAntdApp.ts`:
```typescript
import { App } from 'antd';

/**
 * Hook to access Ant Design's message, modal, and notification APIs.
 * Must be used within components wrapped by the antd App component.
 */
export function useAntdApp() {
  return App.useApp();
}
```

2. Update `frontend/src/main.tsx` to wrap the application:
```typescript
import { StrictMode } from 'react';
import { createRoot } from 'react-dom/client';
import { ConfigProvider, App as AntdApp } from 'antd';
import App from './App';

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <ConfigProvider>
      <AntdApp>
        <App />
      </AntdApp>
    </ConfigProvider>
  </StrictMode>
);
```

Key points:
- ConfigProvider enables theming (using defaults per ANTD-20)
- AntdApp provides context for message/notification/modal APIs
- Import antd's App as AntdApp to avoid collision with our App component
  </action>
  <verify>npm run build compiles without errors related to main.tsx</verify>
  <done>main.tsx wraps application in ConfigProvider and AntdApp; useAntdApp hook created</done>
</task>

<task type="auto">
  <name>Task 3: Replace ToastProvider with antd message API</name>
  <files>
    frontend/src/components/Toast/ToastProvider.tsx
    frontend/src/App.tsx
  </files>
  <action>
1. Delete or empty `frontend/src/components/Toast/ToastProvider.tsx`:
```typescript
/**
 * DEPRECATED: Toast notifications now use Ant Design message API.
 * Use useAntdApp().message instead of importing from sonner.
 * This file kept for backward compatibility during migration.
 */
export function ToastProvider() {
  // No longer needed - antd App component provides message context
  return null;
}
```

2. Update App.tsx to use antd message API instead of sonner's toast:
- Remove: `import { toast } from 'sonner';`
- Add: `import { useAntdApp } from './hooks/useAntdApp';`
- Inside the App component, add: `const { message } = useAntdApp();`
- Replace all `toast.success(...)` with `message.success(...)`
- Replace all `toast.error(...)` with `message.error(...)`

Specific replacements in App.tsx:
- Line 146: `toast.success('Annotated PDF downloaded')` -> `message.success('Annotated PDF downloaded')`
- Line 149: `toast.error(...)` -> `message.error(...)`

Note: The ToastProvider component is still rendered in App.tsx but now returns null. It can be removed entirely in the cleanup plan.
  </action>
  <verify>Run the app with `npm run dev`, trigger a message (e.g., by attempting to generate PDF), verify antd-styled toast appears at top-center (antd default position)</verify>
  <done>All toast notifications use Ant Design message API; sonner dependency fully removed from runtime</done>
</task>

</tasks>

<verification>
1. `npm ls antd` shows v6.x installed
2. `npm run build` completes successfully (ignore warnings about unused imports in components not yet migrated)
3. Application loads without console errors related to antd or context
4. Toast notifications render with Ant Design styling
</verification>

<success_criteria>
- antd ^6 and @ant-design/icons ^6 in package.json dependencies
- ConfigProvider and App wrap the application in main.tsx
- useAntdApp hook exports message/modal/notification
- ToastProvider returns null (deprecated)
- App.tsx uses message.success/error instead of toast
- No runtime errors when app loads
</success_criteria>

<output>
After completion, create `.planning/phases/08-antd-frontend-refactor/08-01-SUMMARY.md`
</output>
