---
phase: 07.1-ai-review-fixes
plan: 01
type: execute
depends_on: []
autonomous: true
---

<objective>
Fix logo detection: extractor outputs mm, prompt hedges uncertainty.

1. Update image extraction to include dimensions in mm (not just points)
2. Add logo detection heuristics (UNEP logo candidates based on position/size)
3. Update AI prompt to hedge uncertainty for implausible measurements
</objective>

<tasks>

<task type="auto">
  <name>Task 1: Add mm dimensions to image extraction</name>
  <files>backend/app/services/image_processor.py</files>
  <action>
Update image extraction to include `width_mm` and `height_mm` fields.

Points to mm conversion: `mm = points / 72 * 25.4`

Add to each extracted image:
- `width_mm`: float
- `height_mm`: float

This gives AI human-readable measurements without requiring unit conversion.
  </action>
  <done>Images include mm dimensions</done>
</task>

<task type="auto">
  <name>Task 2: Update extraction model for mm fields</name>
  <files>backend/app/models/extraction.py</files>
  <action>
Add `width_mm` and `height_mm` Optional[float] fields to ImageInfo model.
  </action>
  <done>Model updated with mm fields</done>
</task>

<task type="auto">
  <name>Task 3: Add logo uncertainty hedging to prompt</name>
  <files>backend/app/ai/prompts.py</files>
  <action>
Add to SYSTEM_PROMPT_TEMPLATE under "Common Pitfalls to Avoid":

```
- If logo dimensions seem implausible (>50mm or <5mm width), note uncertainty rather than stating false measurements
- Logo measurements in extraction are in millimeters (mm) - use directly, don't convert
- Position coordinates are in points from top-left - don't confuse position with size
```
  </action>
  <done>Prompt includes logo uncertainty hedging</done>
</task>

</tasks>

<output>
Create 07.1-01-SUMMARY.md
</output>
