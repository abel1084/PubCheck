---
phase: 07.1-ai-review-fixes
plan: 02
type: execute
depends_on: []
autonomous: true
---

<objective>
Add Print/Digital/Both dropdown for DPI rules.

- Frontend: Add dropdown before Review button
- Backend: Accept output_format parameter
- Prompt: Adjust DPI thresholds based on format
</objective>

<tasks>

<task type="auto">
  <name>Task 1: Add output format state to App.tsx</name>
  <files>frontend/src/App.tsx</files>
  <action>
Add state and dropdown for output format:
- `outputFormat`: 'print' | 'digital' | 'both' (default: 'digital')
- Dropdown in header area near Review button
- Pass to startReview()
  </action>
  <done>Output format dropdown in UI</done>
</task>

<task type="auto">
  <name>Task 2: Update useAIReview to accept outputFormat</name>
  <files>frontend/src/hooks/useAIReview.ts</files>
  <action>
Add `outputFormat: string` parameter to startReview().
Append to FormData: `formData.append('output_format', outputFormat)`
  </action>
  <done>Hook passes output format to backend</done>
</task>

<task type="auto">
  <name>Task 3: Accept output_format in backend endpoint</name>
  <files>backend/app/ai/router.py</files>
  <action>
Add `output_format: str = Form("digital")` parameter.
Pass to review_document().
  </action>
  <done>Endpoint accepts output_format</done>
</task>

<task type="auto">
  <name>Task 4: Update reviewer to use output_format for DPI rules</name>
  <files>backend/app/ai/reviewer.py, backend/app/ai/prompts.py</files>
  <action>
Update build_user_prompt to include DPI guidance based on output_format:
- digital: 72 DPI minimum
- print: 300 DPI minimum
- both: 150 DPI minimum

Add to user prompt:
```
Document output format: {output_format}
DPI requirements: {dpi_min} DPI minimum for this format
```
  </action>
  <done>DPI rules adjusted by output format</done>
</task>

</tasks>

<output>
Create 07.1-02-SUMMARY.md
</output>
